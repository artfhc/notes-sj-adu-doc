---
import type { Issue } from '../lib/schema';
import { roomDisplayNames } from '../lib/schema';
import { getMediaForIssue } from '../lib/content';
import Badge from './Badge.astro';

export interface Props {
  issue: Issue;
}

const { issue } = Astro.props;
const mediaCount = getMediaForIssue(issue.id).length;
---

<div class="bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
  <a href={`/issues/${issue.slug}`} class="block p-6">
    <div class="flex items-start justify-between mb-3">
      <h3 class="text-lg font-semibold text-gray-900 hover:text-blue-600 transition-colors">
        {issue.title}
      </h3>
      <Badge status={issue.status} />
    </div>

    <p class="text-gray-600 text-sm mb-4">{issue.summary}</p>

    <div class="flex flex-wrap gap-2 mb-3">
      {issue.rooms.map((room) => (
        <span class="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700">
          {roomDisplayNames[room]}
        </span>
      ))}
    </div>

    <div class="text-sm text-gray-500">
      {mediaCount} {mediaCount === 1 ? 'item' : 'items'} of evidence
    </div>
  </a>
</div>
